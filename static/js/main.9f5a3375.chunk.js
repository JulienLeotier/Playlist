(this.webpackJsonpplaylist=this.webpackJsonpplaylist||[]).push([[0],{27:function(t,e,n){t.exports=n(43)},36:function(t,e,n){},37:function(t,e,n){},38:function(t,e,n){},39:function(t,e,n){},40:function(t,e,n){},42:function(t,e,n){},43:function(t,e,n){"use strict";n.r(e);var a=n(0),o=n.n(a),r=n(16),i=n.n(r),s=n(9),l=n(13),c=n(2),u={SET_SONG_DATA:"SET_SONG_DATA",SET_SONG_DURATION:"SET_SONG_DURATION",SET_LYRICS_DATA:"SET_LYRICS_DATA",SET_PLAYLIST_DATA:"SET_PLAYLIST_DATA",FETCH_PLAYLIST_BEGIN:"FETCH_PLAYLIST_BEGIN",FETCH_PLAYLIST_FAILURE:"FETCH_PLAYLIST_FAILURE",SET_CURRENT_SONG_INDEX:"SET_CURRENT_SONG_INDEX",SET_AUDIO_DATA:"SET_AUDIO_DATA",SET_PLAY_STATE:"SET_PLAY_STATE",SHOW_PLAYLIST:"SHOW_PLAYLIST"},d={song_name:void 0,artist_name:void 0,song_duration:void 0,song_album_art:void 0,song_audio_link:void 0,song_lyrics_data:void 0,song_lyrics_link:void 0,play:!1};var p={playlistData:void 0,loading:!1,error:null,currentSongIndex:void 0,audioData:void 0,showPlaylist:!0};var g=Object(l.c)({song:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case u.SET_SONG_DATA:return Object(c.a)(Object(c.a)({},t),{},{song_name:e.payload.song_name,artist_name:e.payload.artist_name,song_album_art:e.payload.song_album_art,song_lyrics_link:e.payload.song_lyrics_link,song_audio_link:e.payload.song_audio_link});case u.SET_SONG_DURATION:return Object(c.a)(Object(c.a)({},t),{},{song_duration:e.payload.song_duration});case u.SET_LYRICS_DATA:return Object(c.a)(Object(c.a)({},t),{},{song_lyrics_data:e.payload.song_lyrics_data});case u.SET_PLAY_STATE:return Object(c.a)(Object(c.a)({},t),{},{play:e.payload.play});default:return Object(c.a)({},t)}},playlist:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case u.FETCH_PLAYLIST_BEGIN:return Object(c.a)(Object(c.a)({},t),{},{loading:!0,error:null});case u.FETCH_PLAYLIST_FAILURE:return Object(c.a)(Object(c.a)({},t),{},{loading:!1,error:e.payload.error});case u.SET_PLAYLIST_DATA:return Object(c.a)(Object(c.a)({},t),{},{loading:!1,playlistData:e.payload.playlistData,error:null});case u.SET_CURRENT_SONG_INDEX:return Object(c.a)(Object(c.a)({},t),{},{currentSongIndex:e.payload.currentSongIndex});case u.SET_AUDIO_DATA:return Object(c.a)(Object(c.a)({},t),{},{audioData:e.payload.audioData});case u.SHOW_PLAYLIST:return Object(c.a)(Object(c.a)({},t),{},{showPlaylist:e.payload.showPlaylist});default:return Object(c.a)({},t)}}}),y=n(25),m=Object(l.d)(g,Object(l.a)(y.a)),h=n(7),v=n(8),f=n(12),_=n(11),S=(n(36),n(26)),E=n(3),T=(n(37),function(){function t(){Object(h.a)(this,t)}return Object(v.a)(t,null,[{key:"handleErrors",value:function(t){if(!t.ok)throw new Error(t.status);return t}}]),t}());function b(){return function(t){return t({type:u.FETCH_PLAYLIST_BEGIN}),fetch("/playlist/playlist.json",{credentials:"omit",method:"GET"}).then(T.handleErrors).then((function(t){return t.json()})).then((function(e){var n;t((n=e.songs,{type:u.SET_PLAYLIST_DATA,payload:{playlistData:n}}))})).catch((function(e){t(function(t){return{type:u.FETCH_PLAYLIST_FAILURE,payload:{error:t}}}(e))}))}}function I(t){return function(e){e(function(t){return{type:u.SET_SONG_DATA,payload:{song_name:t.song,artist_name:t.author,song_album_art:t.albumart,song_lyrics_link:t.json,song_audio_link:t.audio}}}(t))}}var L=function(t){return{type:u.SET_LYRICS_DATA,payload:{song_lyrics_data:t}}};var D=function(t){return{type:u.SET_CURRENT_SONG_INDEX,payload:{currentSongIndex:t}}},A=function(t){return{type:u.SET_AUDIO_DATA,payload:{audioData:t}}},O=function(t){return{type:u.SET_PLAY_STATE,payload:{play:t}}},w=function(t){return{type:u.SHOW_PLAYLIST,payload:{showPlaylist:t}}},P=function(t){Object(f.a)(n,t);var e=Object(_.a)(n);function n(){var t;Object(h.a)(this,n);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(t=e.call.apply(e,[this].concat(o))).togglePlaylist=function(){var e=t.props;(0,e.setShowPlaylist)(!e.showPlaylistBool)},t}return Object(v.a)(n,[{key:"render",value:function(){var t=this.props,e=t.song_name,n=t.artist_name,a=t.showPlaylistBool?"hide":"";return o.a.createElement("header",null,o.a.createElement("div",{id:"top-bar",className:"flex vrtlCenter"},o.a.createElement("button",{id:"back",onClick:this.togglePlaylist},o.a.createElement("i",{className:"fa fa-arrow-left"})),o.a.createElement("div",{id:"about-song",className:"".concat(a)},o.a.createElement("h2",{className:"song-name"},e),o.a.createElement("h4",{className:"artist-name low-text-opacity"},n))))}}]),n}(a.Component),j=Object(s.b)((function(t){return{song_name:t.song.song_name,artist_name:t.song.artist_name,showPlaylistBool:t.playlist.showPlaylist}}),(function(t){return{setShowPlaylist:function(e){return t(w(e))},setAudioData:function(e){return t(A(e))}}}))(P),k=(n(38),function(t){Object(f.a)(n,t);var e=Object(_.a)(n);function n(t){var a;Object(h.a)(this,n),(a=e.call(this,t)).handleTouchDrag=function(t){var e,n,o,r=a.state.audio.duration,i=a.state.audio;n=document.querySelector("#progress-bar").clientWidth,o=document.querySelector("#progress-bar").getBoundingClientRect().left;var s=parseInt(t.touches[0].clientX-o)/parseInt(n)*100;e=parseInt(r*(s/100)),s>100&&(s=100),document.querySelector("#progress").style.width=s+"%",i.paused||i.pause(),i.currentTime=e>=r?r-1:e,a.setState({audio:i,seek:!0})},a.handleDrag=function(t){var e,n,o,r=a.state.audio.duration,i=a.state.audio;n=document.querySelector("#progress-bar").clientWidth,o=document.querySelector("#progress-bar").getBoundingClientRect().left;var s=parseInt(t.clientX-o)/parseInt(n)*100;e=parseInt(r*(s/100)),s>100&&(s=100),document.querySelector("#progress").style.width=s+"%",i.paused||i.pause(),i.currentTime=e>=r?r-1:e,a.setState({audio:i,seek:!0})},a.togglePlay=function(){var t=document.querySelector("#menu #play");t.children[0].classList.contains("fa-play")?(t.children[0].classList.remove("fa-play"),t.children[0].classList.add("fa-pause"),a.state.audio.play(),a.setState({play:!0})):(t.children[0].classList.remove("fa-pause"),t.children[0].classList.add("fa-play"),a.state.audio.pause(),a.setState({play:!1}))},a.bindKeysHandler=function(t){t.stopPropagation(),t.preventDefault();var e=t.keyCode?t.keyCode:t.which;if(32===e)a.togglePlay();else if(82===e)a.setState({repeat:!a.state.repeat});else if(83===e)a.setState({shuffle:!a.state.shuffle});else if(78===e)a.nextSong();else if(80===e)a.prevSong();else if(27===e)a.togglePlaylist();else if(39===e){var n=a.state.audio,o=(1e3*n.currentTime+5e3)/1e3;o>=n.duration?n.currentTime=(1e3*n.duration-1e3)/1e3:n.currentTime=o,a.setState({audio:n})}else if(37===e){var r=a.state.audio,i=(1e3*r.currentTime-5e3)/1e3;r.currentTime=i<=0?0:i,a.setState({audio:r})}},a.togglePlaylist=function(){var t=a.props;(0,t.setShowPlaylist)(!t.showPlaylistBool)},a.parseTime=function(t){var e=parseInt(t/6e4),n=parseInt(t%6e4/1e3);return n<10&&(n="0".concat(n)),"".concat(e,":").concat(n)},a.setTotalTime=function(){a.setState({totalTime:a.parseTime(parseInt(1e3*a.state.audio.duration))}),a.state.audio.removeEventListener("loadeddata",(function(t){console.log("Total Time is set!"),a.setTotalTime()}))},a.setCurrentTime=function(){var t=a.state.audio;a.setState({currentTime:a.parseTime(parseInt(1e3*t.currentTime)),percent:t.currentTime/t.duration*100})},a.prevSong=function(){var t=a.props,e=t.playlistData,n=t.currentSongIndex,o=t.setCurrentSongIndex,r=t.setSongData;if(void 0!==e&&e.length>0){var i=(n-1+e.length)%e.length;o(i),r(e[i])}},a.getNextNum=function(t,e){for(;t;){var n=parseInt(100*Math.random());if(n%e!==0)return n}return 1},a.nextSong=function(){var t=a.props,e=t.playlistData,n=t.currentSongIndex,o=t.setCurrentSongIndex,r=t.setSongData,i=a.state,s=i.shuffle,l=i.repeat;if(void 0!==e&&e.length>0){var c=(n+a.getNextNum(s,e.length))%e.length;n+1===e.length&&!1===l&&a.setState({play:!1}),o(c),r(e[c])}};var o=new Audio;return t.setAudioData(o),a.state={totalTime:void 0,currentTime:"-:--",audio:o,timer:void 0,percent:0,src:void 0,play:!1,seek:!1,repeat:!1,shuffle:!1},a}return Object(v.a)(n,[{key:"componentDidMount",value:function(){var t=this,e=this.state.audio;e.addEventListener("playing",(function(e){console.log("Audio is Playing"),t.setState({timer:setInterval(t.setCurrentTime,1e3)})})),e.addEventListener("pause",(function(e){console.log("Audio is Paused"),clearInterval(t.state.timer)})),e.addEventListener("loadeddata",(function(e){console.log("Total Time is set!"),t.setTotalTime()})),e.addEventListener("ended",(function(e){console.log("Song ended!"),t.togglePlaylist()})),window.addEventListener("mouseup",(function(n){window.removeEventListener("mousemove",t.handleDrag),t.state.play&&t.state.audio.play(),t.setState({audio:e,seek:!1})})),window.addEventListener("touchend",(function(n){window.removeEventListener("touchmove",t.handleTouchDrag),t.state.play&&t.state.audio.play(),t.setState({audio:e,seek:!1})})),window.addEventListener("keyup",this.bindKeysHandler)}},{key:"componentDidUpdate",value:function(t,e){if(t.song_audio_link!==this.props.song_audio_link){console.log("Audio is Changed");var n=this.state.audio;n.src=this.props.song_audio_link,this.state.play&&n.play(),this.setState({totalTime:"-:--",currentTime:"0:00",percent:0,src:this.props.song_audio_link})}this.state.play!==e.play?this.props.setPlayState(this.state.play):this.state.play===e.play&&this.state.play!==this.props.play&&this.togglePlay()}},{key:"render",value:function(){var t=this,e=this.state,n=e.totalTime,a=e.currentTime,r=e.percent;return o.a.createElement("footer",null,o.a.createElement("div",{id:"player"},o.a.createElement("div",{id:"bar",className:"flex vrtlCenter hrtlCenter"},o.a.createElement("div",{id:"currentTime"},a),o.a.createElement("div",{id:"progress-bar",onTouchStart:function(e){e.stopPropagation(),t.handleTouchDrag(e),window.addEventListener("touchmove",t.handleTouchDrag)},onMouseDown:function(e){e.stopPropagation(),t.handleDrag(e),window.addEventListener("mousemove",t.handleDrag)}},o.a.createElement("div",{id:"progress",style:{width:"".concat(r,"%")}},o.a.createElement("i",{id:"progressButton",className:"fa fa-circle",onTouchStart:function(e){e.stopPropagation(),window.addEventListener("touchmove",t.handleTouchDrag)},onMouseDown:function(e){e.stopPropagation(),window.addEventListener("mousemove",t.handleDrag)}}))),o.a.createElement("div",{id:"totalTime"},void 0===n?a:n)),o.a.createElement("div",{id:"menu"},o.a.createElement("button",{id:"play",onClick:function(e){return t.togglePlay()}},o.a.createElement("i",{className:"fa fa-play"})))))}}]),n}(a.Component)),C=Object(s.b)((function(t){return{song_audio_link:t.song.song_audio_link,currentSongIndex:t.playlist.currentSongIndex,playlistData:t.playlist.playlistData,play:t.song.play,showPlaylistBool:t.playlist.showPlaylist}}),(function(t){return{setSongData:function(e){return t(I(e))},setCurrentSongIndex:function(e){return t(D(e))},setAudioData:function(e){return t(A(e))},setPlayState:function(e){return t(O(e))},setShowPlaylist:function(e){return t(w(e))}}}))(k),N=(n(39),function(t){Object(f.a)(n,t);var e=Object(_.a)(n);function n(t){var a;Object(h.a)(this,n),(a=e.call(this,t)).setIntervalFunction=function(){console.log("Lyrics Synchronization is resumed"),a.setState({timer:setInterval(a.updateLyricsOnTop,1e3)})},a.clearIntervalFunction=function(){console.log("Lyrics Synchronization is paused"),clearInterval(a.state.timer)},a.updateLyricsOnTop=function(){var t=document.querySelectorAll("#lyrics-content > h2"),e=document.querySelectorAll("#lyrics-content > h2.on-top"),n=!0;try{t.forEach((function(o,r){if(0===r){var i=parseInt(o.getAttribute("data-time"));if(parseInt(1e3*a.props.audioData.currentTime)<i)throw e.length>0&&e.forEach((function(t){t.classList.remove("on-top")})),new Error("No need to iterate further")}if(o.classList.contains("on-top")&&(o.classList.remove("on-top"),o.classList.add("on-view")),r+1<t.length&&!0===n){var s=parseInt(t[r+1].getAttribute("data-time"));if(parseInt(1e3*a.props.audioData.currentTime)<s&&!o.classList.contains("on-top"))return o.classList.add("on-top"),a.centerize(),void(n=!1)}else if(void 0!==o&&r+1===t.length){var l=parseInt(t[r].getAttribute("data-time"));parseInt(1e3*a.props.audioData.currentTime)>=l&&(o.classList.contains("on-top")||o.classList.add("on-top"))}}))}catch(o){return}};var o=t.playlistData,r=t.setSongData,i=t.setCurrentSongIndex,s=t.song_name;if(void 0!==o&&o.length>0&&void 0===s){i(0),r(o[0])}return a.state={timer:void 0},a}return Object(v.a)(n,[{key:"componentDidMount",value:function(){var t=this.props.audioData;void 0!==t&&void 0!==this.props.song_lyrics_link&&(t.addEventListener("playing",this.setIntervalFunction),t.addEventListener("pause",this.clearIntervalFunction),console.log("Lyrics Updated!"),this.props.getLyricsData(this.props.song_lyrics_link))}},{key:"componentWillUnmount",value:function(){var t=this.props.audioData;void 0!==t&&(t.removeEventListener("playing",this.setIntervalFunction),t.removeEventListener("pause",this.clearIntervalFunction))}},{key:"centerize",value:function(){if(0!==document.querySelectorAll(".on-top").length){var t=document.querySelector(".on-top"),e=t.getBoundingClientRect().height,n=document.querySelector("#lyrics").getBoundingClientRect().height,a=1/3;n<200&&(a=.02);var o=t.getBoundingClientRect().top-t.parentNode.getBoundingClientRect().top+e/2-n*a;o<0&&(o=0),document.querySelector("#lyrics").scrollTo(0,o)}}},{key:"render",value:function(){var t=this.props.song_lyrics_data,e=[];return void 0!==t&&t.length>0&&(e=[],t.forEach((function(t,n){e.push(o.a.createElement("h2",{key:n,"data-time":t.time},t.line))}))),o.a.createElement(o.a.Fragment,null,o.a.createElement("section",null,o.a.createElement("div",{id:"lyrics"},o.a.createElement("div",{id:"lyrics-content"},e))))}}]),n}(a.Component)),x=Object(s.b)((function(t){return{playlistData:t.playlist.playlistData,song_name:t.song.song_name,artist_name:t.song.artist_name,song_lyrics_link:t.song.song_lyrics_link,song_lyrics_data:t.song.song_lyrics_data,audioData:t.playlist.audioData}}),(function(t){return{setSongData:function(e){return t(I(e))},getLyricsData:function(e){return t(function(t){return function(e){return e(L([{line:"Loading",time:0}])),fetch(t,{credentials:"omit",method:"GET"}).then(T.handleErrors).then((function(t){return t.json()})).then((function(t){e(L(t.lyrics))})).catch((function(t){e(L([{line:"Unable to load lyrics"}]))}))}}(e))},setCurrentSongIndex:function(e){return t(D(e))}}}))(N),R=(n(40),function(t){Object(f.a)(n,t);var e=Object(_.a)(n);function n(t){var a;return Object(h.a)(this,n),(a=e.call(this,t)).searchSongs=function(t){var e=t.currentTarget.value.toLowerCase().trim();document.querySelectorAll(".song-list-row").forEach((function(t){t.textContent.toLowerCase().includes(e)?t.style.display="flex":t.style.display="none"}))},a.state={showPlaylist:"show"},a}return Object(v.a)(n,[{key:"playThisSong",value:function(t){var e=this.props,n=e.setCurrentSongIndex,a=e.setSongData,o=e.currentSongIndex,r=e.setPlayState,i=e.play,s=e.playlistData,l=e.setShowPlaylist;t!==o&&!1===i?r(!0):o===t&&r(!i),n(t),a(s[t]),l(!1)}},{key:"render",value:function(){var t,e=this,n=this.props,a=n.playlistData,r=n.song_name,i=n.play,s=n.showPlaylist,l=n.setPlayState;s?(l(!1),t="show"):t="";var c=[];return void 0!==a&&a.length>0&&(c=[],a.forEach((function(t,n){c.push(o.a.createElement("div",{key:n,"data-index":n,className:"flex vrtlCenter hrtlCenter song-list-row element options",onClick:function(t){return e.playThisSong(n)}},o.a.createElement("div",{className:"album-art"},o.a.createElement("img",{alt:t.song,src:t.albumart})),o.a.createElement("div",{className:"song-details"},o.a.createElement("h2",{className:"song"},t.song),o.a.createElement("h4",{className:"artist"},t.author)),o.a.createElement("div",{className:"options"},r===t.song&&i&&o.a.createElement("p",null,"50"),(r!==t.song||!i)&&o.a.createElement("p",null,"50"))))}))),o.a.createElement("div",{id:"playlist",className:"".concat(t)},o.a.createElement("div",{id:"label"},o.a.createElement("h1",null,"N'oubliez l'anniv de M\xe9lissa")),o.a.createElement("div",{id:"show-box"},o.a.createElement("div",{id:"show-list"},c.length>0&&o.a.createElement("div",{className:"song-list"},c))))}}]),n}(a.Component)),Y=Object(s.b)((function(t){return{playlistData:t.playlist.playlistData,song_name:t.song.song_name,currentSongIndex:t.playlist.currentSongIndex,play:t.song.play,showPlaylist:t.playlist.showPlaylist}}),(function(t){return{setSongData:function(e){return t(I(e))},setCurrentSongIndex:function(e){return t(D(e))},setPlayState:function(e){return t(O(e))},setShowPlaylist:function(e){return t(w(e))}}}))(R),F=function(t){Object(f.a)(n,t);var e=Object(_.a)(n);function n(t){var a;Object(h.a)(this,n),a=e.call(this,t);var o=t.playlistData,r=t.loading,i=t.getPlaylist;return void 0===o&&!1===r&&i(),a}return Object(v.a)(n,[{key:"render",value:function(){var t=this.props.song_album_art;return o.a.createElement(S.a,null,o.a.createElement("img",{className:"album-art-background",alt:"album-art-background",src:t}),o.a.createElement(j,null),o.a.createElement(E.c,null,o.a.createElement(E.a,{exact:!0,path:"/",component:function(){return o.a.createElement(x,null)}})),o.a.createElement(Y,null),o.a.createElement(C,null))}}]),n}(a.Component),U=Object(s.b)((function(t){return{playlistData:t.playlist.playlistData,loading:t.playlist.loading,song_album_art:t.song.song_album_art}}),(function(t){return{getPlaylist:function(){return t(b())}}}))(F);n(42),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(s.a,{store:m},o.a.createElement(U,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}},[[27,1,2]]]);
//# sourceMappingURL=main.9f5a3375.chunk.js.map